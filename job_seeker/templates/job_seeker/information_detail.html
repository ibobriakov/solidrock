{% extends 'userprofile/base.html' %}
{% load serialize %}

{% block templates %}
    {{ block.super }}
    <script id="job_seeker_information_form_template" type="text/template">
        <% _.each(collection.models,function(element, index) { %>
        <div class="title">Personal Information</div>
            {% include "job_seeker/information_form_template.html" %}
        <% }) %>
        <div class="_submit">
            <div class="exit" data-on-click="job_seeker_information_view:commit_and_exit">Save and Exit</div>
            <div class="cont" data-on-click="job_seeker_information_view:commit" >Save and Continue</div>
        </div>
    </script>
    <script id="job_seeker_current_employment_form_template" type="text/template">
        <% _.each(collection.models,function(element, index) { %>
        <div class="title">Current Employment</div>
        <div class="text">(If now unemployed give details of last employer)</div>
            {% include "job_seeker/current_employment_form_template.html" %}
        <% }) %>
        <div class="_submit">
            <div class="exit" data-on-click="job_seeker_current_employment_view:commit_and_exit">Save and Exit</div>
            <div class="cont" data-on-click="job_seeker_current_employment_view:commit" >Save and Continue</div>
        </div>
    </script>
    <script id="job_seeker_previous_employment_form_template" type="text/template">
        <% _.each(collection.models,function(element, index) { %>
        <div class="title">Previous Employment</div>
        <% if (index) { %><a href="#" data-on-click="job_seeker_previous_employment_view:remove" data-cid="<%=element.cid%>">remove</a><% } %>
        <div class="text">(Most recent Employer first. Please cover you last three positions if applicable)</div>
            {% include "job_seeker/previous_employment_form_template.html" %}
        <% }) %>
        <a href="#" data-on-click="job_seeker_previous_employment_view:create">Add Another Position</a>
        <div class="_submit">
            <div class="exit" data-on-click="job_seeker_previous_employment_view:commit_and_exit">Save and Exit</div>
            <div class="cont" data-on-click="job_seeker_previous_employment_view:commit" >Save and Continue</div>
        </div>
    </script>
    <script id="job_seeker_education_form_template" type="text/template">
        <div class="title">Education</div>
        <div class="text">(Qualifications from Schools, Colleges and Universities. Please list your highest qualification first.)</div>
        <fieldset>
            <div class="field">
                <label>School, College, or University Name</label>
                <% _.each(collection.where({'education_type':'school-college-or-university-name'}),function(element,index){ %>
                    <input data-value="<%=type%>_<%=element.cid%>.value" class="it4" type="text"> <% if (index) { %><a href="#" data-on-click="job_seeker_education_view:remove" data-cid="<%=element.cid%>">remove</a><% } %>
                    <% if (element.errors) { %>
                    <div class="error_list">
                        <% _.each(element.errors['education_type'],function(value){ %>
                        <p><%=value%></p>
                        <% }) %>
                        <% _.each(element.errors['value'],function(value){ %>
                        <p><%=value%></p>
                        <% }) %>
                    </div>
                    <% } %>
                <% }) %>
                <a href="#" data-type-name="education_type" data-type="school-college-or-university-name" data-on-click="job_seeker_education_view:create_by_type">Add another School, College or University</a>
            </div>
            <div class="field">
                <label>Major Course of Study or Classes Taken</label>
                <% _.each(collection.where({'education_type':'major-course-of-study-or-classes-taken'}),function(element,index){ %>
                <input data-value="<%=type%>_<%=element.cid%>.value" class="it4" type="text"> <% if (index) { %><a href="#" data-on-click="job_seeker_education_view:remove" data-cid="<%=element.cid%>">remove</a><% } %>
                <% if (element.errors) { %>
                <div class="error_list">
                    <% _.each(element.errors['education_type'],function(value){ %>
                    <p><%=value%></p>
                    <% }) %>
                    <% _.each(element.errors['value'],function(value){ %>
                    <p><%=value%></p>
                    <% }) %>
                </div>
                <% } %>
                <% }) %>
                <a href="#" data-type-name="education_type" data-type="major-course-of-study-or-classes-taken" data-on-click="job_seeker_education_view:create_by_type">Add another Major Course of Study or Class Taken</a>
            </div>
            <div class="field">
                <label>Degrees and/or Post-Graduate Qualifications Obtained</label>
                <% _.each(collection.where({'education_type':'degrees-andor-post-graduate-qualifications-obtained'}),function(element,index){ %>
                <input data-value="<%=type%>_<%=element.cid%>.value" class="it4" type="text"> <% if (index) { %><a href="#" data-on-click="job_seeker_education_view:remove" data-cid="<%=element.cid%>">remove</a><% } %>
                <% if (element.errors) { %>
                <div class="error_list">
                    <% _.each(element.errors['education_type'],function(value){ %>
                    <p><%=value%></p>
                    <% }) %>
                    <% _.each(element.errors['value'],function(value){ %>
                    <p><%=value%></p>
                    <% }) %>
                </div>
                <% } %>
                <% }) %>
                <a href="#" data-type-name="education_type" data-type="degrees-andor-post-graduate-qualifications-obtained" data-on-click="job_seeker_education_view:create_by_type">Add another Degree and/or Post-Graduate Qualification Obtained</a>
            </div>
            <div class="field">
                <label>Certificates and/or Diplomas Obtained</label>
                <% _.each(collection.where({'education_type':'certificates-andor-diplomas-obtained'}),function(element,index){ %>
                <input data-value="<%=type%>_<%=element.cid%>.value" class="it4" type="text"> <% if (index) { %><a href="#" data-on-click="job_seeker_education_view:remove" data-cid="<%=element.cid%>">remove</a><% } %>
                <% if (element.errors) { %>
                <div class="error_list">
                    <% _.each(element.errors['education_type'],function(value){ %>
                    <p><%=value%></p>
                    <% }) %>
                    <% _.each(element.errors['value'],function(value){ %>
                    <p><%=value%></p>
                    <% }) %>
                </div>
                <% } %>
                <% }) %>
                <a href="#" data-type-name="education_type" data-type="certificates-andor-diplomas-obtained" data-on-click="job_seeker_education_view:create_by_type">Add another Certificate and/or Diploma Obtained</a>
            </div>
            <div class="field">
                <label>Any Other Course Currently Enrolled In</label>
                <% _.each(collection.where({'education_type':'any-other-course-currently-enrolled-in'}),function(element,index){ %>
                <input data-value="<%=type%>_<%=element.cid%>.value" class="it4" type="text"> <% if (index) { %><a href="#" data-on-click="job_seeker_education_view:remove" data-cid="<%=element.cid%>">remove</a><% } %>
                <% if (element.errors) { %>
                <div class="error_list">
                    <% _.each(element.errors['education_type'],function(value){ %>
                    <p><%=value%></p>
                    <% }) %>
                    <% _.each(element.errors['value'],function(value){ %>
                    <p><%=value%></p>
                    <% }) %>
                </div>
                <% } %>
                <% }) %>
            </div>
            </fieldset>
        <div class="_submit">
            <div class="exit" data-on-click="job_seeker_education_view:commit_and_exit">Save and Exit</div>
            <div class="cont" data-on-click="job_seeker_education_view:commit" >Save and Continue</div>
        </div>
    </script>
    <script id="job_seeker_referee_form_template" type="text/template">
        <% _.each(collection.models,function(element, index) { %>
        <div class="title">Referees</div>
        <% if (index) { %><a href="#" data-on-click="job_seeker_referee_view:remove" data-cid="<%=element.cid%>">remove</a><% } %>
        <div class="text">(Please give the names and addresses of your two most recent employers or other work related referees.)</div>
        {% include "job_seeker/referee_form_template.html" %}
        <% }) %>
        <a href="#" data-on-click="job_seeker_referee_view:create">Add Another Position</a>
        <div class="_submit">
            <div class="exit" data-on-click="job_seeker_referee_view:commit_and_exit">Save and Exit</div>
        </div>
    </script>
{% endblock %}

{% block content %}
    <div class="_content stages" xmlns="http://www.w3.org/1999/html">
        <a id="section_top"></a>
        <h1>Your Application Information</h1>
        <div class="left">
            <ul class="sections_text">
                <li class="section1 active"><a href="#section/1">Section 1: Personal Information</a></li>
                <li class="section2" ><a href="#section/2">Section 2: Current Employment</a></li>
                <li class="section3" ><a href="#section/3">Section 3: Previous Employment</a></li>
                <li class="section4" ><a href="#section/4">Section 4: Education</a></li>
                <li class="section5" ><a href="#section/5">Section 5: References</a></li>
                <li><a href="#">Submit and Terms</a></li>
            </ul>
        </div>
        <div class="right">
            <ul class="sections_tab">
                <li class="section1 active"><a href="#section/1">Section 1</a></li>
                <li class="section2"><a href="#section/2">Section 2</a></li>
                <li class="section3"><a href="#section/3">Section 3</a></li>
                <li class="section4"><a href="#section/4">Section 4</a></li>
                <li class="section5"><a href="#section/5">Section 5</a></li>
            </ul>
            <div class="form sections_form">
                <form>
                    <div class="page section1"></div>
                    <div class="page section2" style="display: none"></div>
                    <div class="page section3" style="display: none"></div>
                    <div class="page section4" style="display: none"></div>
                    <div class="page section5" style="display: none"></div>
                    <script>
                        var page_dict = {
                            'job_seeker_information':{
                                'section':1,
                                'collection': {% autoescape off %}{{ profile.personal_information|as_json }}{% endautoescape %}
                            },
                            'job_seeker_current_employment':{
                                'section':2,
                                'collection': {% autoescape off %}{{ profile.current_employment|as_json }}{% endautoescape %}
                            },
                            'job_seeker_previous_employment':{
                                'section':3,
                                'collection': {% autoescape off %}{{ profile.previous_employments_set.all|as_json }}{% endautoescape %}
                            },
                            'job_seeker_education':{
                                'section':4,
                                'collection': {% autoescape off %}{{ profile.educations_set.all|as_json }}{% endautoescape %}
                            },
                            'job_seeker_referee':{
                                'section':5,
                                'collection': {% autoescape off %}{{ profile.referees_set.all|as_json }}{% endautoescape %}
                            }

                        };
                        _.each(page_dict,function(value,key) {
                            new (profile_view_fabric(key))({
                                el: $('div.page.section'+value.section),
                                collection: new (profile_collection_fabric(key))(value.collection)
                            });
                        });
                    </script>
                </form>
            </div>
        </div>
    </div>
{% endblock %}

