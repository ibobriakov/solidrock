{% extends 'resume/base.html' %}
{% load mptt_tags %}
{% load serialize %}

{% block content %}
    <div class="_content builder">
        <h1>Resume Builder<a href="{% url "job_seeker.profile.base" %}">Exit Resume Builder</a></h1>
        <div class="top">
            <div class="title">Resume</div>
            <form>
                <input type="text" data-value="resume_name.name">
                <div class="links">
                    <a class="link" href="#">Resume Builder Instructions</a>
{#                    <div class="pop">Popluate</div>#}
{#                    <div class="save">Save</div>#}
                </div>
            </form>
        </div>
        <div class="nav">
{#            <ul class="pages">#}
{#                <li id="str1" class="active">Page 1</li>#}
{#            </ul>#}
            <div class="info2">
                <div class="title">Jump to Another Resume</div>
                {{ resume_select.resume }}
            </div>
            <div class="info1">
                <ul>
                    <li data-text="resume_name.name"></li>
{#                    <li class="sep">|</li>#}
{#                    <li class="page">Page 1</li>#}
                </ul>
            </div>
        </div>
        <div class="list str1">
            <ul class="links">
{#                <li><a href="#">view resume</a></li>#}
{#                <li>|</li>#}
                <li><a href="{% url 'resume.pdf' object.pk %}">download a PDF</a></li>
            </ul>
            <div class="list_it"></div>
        </div>

    </div>
{% endblock %}

{% block initialize-js %}
    <script>
        var type = 'resume', paper = {{ object.pk }}, button = true;
        var paper_view = new (paper_view_factory(type,paper,button))({el: $('.list_it')});
        paper_view.collection.reset([
            {% recursetree object.resumeitem_set.all %}
                { {{ node.as_json|safe }}
                {% if not node.is_leaf_node %},'children': new (paper_collection_factory(type,paper))().reset([{{ children }}])},{% else %}},{% endif %}
            {% endrecursetree %}
        ]);
        paper_view.render();
        var paper_name_view = new (paper_name_view_factory('resume_name'))({el:$('._content.builder')});
        paper_name_view.model.set({{ object|as_json|safe }}[0]);
        paper_name_view.bindel();
        $('#id_resume').change(function(){
            document.location = $('#id_resume').val();
        });
    </script>
{% endblock %}